{% extends "base.html" %}

{% block title %}{{ config.FORUM_NAME }}{% endblock %}

{% block content %}
<div class="forum-header">
    <h1>Willkommen im {{ config.FORUM_NAME }}</h1>
    <p>{{ config.FORUM_DESCRIPTION }}</p>
</div>

<div class="categories-list">
    {% for category in categories %}
        <div class="category-item">
            <div class="category-main">
                <h2>
                    <a href="{{ url_for('forum.category', category_id=category.id) }}">
                        {{ category.name }}
                    </a>
                </h2>
                {% if category.description %}
                    <p>{{ category.description }}</p>
                {% endif %}
                
                <div class="category-stats">
                    <span>{{ category.get_thread_count() }} Threads</span>
                    <span>{{ category.get_post_count() }} Beitr√§ge</span>
                </div>
            </div>
            
            {% if category.subcategories %}
                <div class="subcategories">
                    <h3>Unterkategorien:</h3>
                    {% for subcat in category.subcategories %}
                        <a href="{{ url_for('forum.category', category_id=subcat.id) }}" class="subcategory-link">
                            {{ subcat.name }}
                        </a>
                    {% endfor %}
                </div>
            {% endif %}
            
            {% set last_post = category.get_last_post() %}
            {% if last_post %}
                <div class="category-last-post">
                    <small>
                        Letzter Beitrag in 
                        <a href="{{ url_for('forum.thread', thread_id=last_post.thread.id) }}">
                            {{ last_post.thread.title }}
                        </a>
                        <br>
                        von <a href="{{ url_for('forum.user_profile', username=last_post.author.username) }}">
                            {{ last_post.author.username }}
                        </a>
                        {{ last_post.created_at.strftime('%d.%m.%Y %H:%M') }}
                    </small>
                </div>
            {% endif %}
        </div>
    {% endfor %}
</div>

{% if not categories %}
<div class="empty-state">
    <h2>Noch keine Kategorien vorhanden</h2>
    <p>Die Forum-Struktur wird gerade eingerichtet.</p>
</div>
{% endif %}
{% endblock %}